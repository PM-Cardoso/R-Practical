<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Programming Practical - P1 | R-Practical</title>
  <meta name="description" content="2 Programming Practical - P1 | R-Practical" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Programming Practical - P1 | R-Practical" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="2 Programming Practical - P1 | R-Practical" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Programming Practical - P1 | R-Practical" />
  
  <meta name="twitter:description" content="2 Programming Practical - P1 | R-Practical" />
  

<meta name="author" content="Pedro Cardoso" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="programming-practical---p2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script language="javascript"> 
    function toggle(id) {
        var ele = document.getElementById("toggleText" + id);
        var text = document.getElementById("displayText" + id);
        var buttonText = text.innerHTML.replace("Show: ", "");
        buttonText = buttonText.replace("Hide: ", "");
        if(ele.style.display == "block") {
            ele.style.display = "none";
            text.innerHTML = "Show: " + buttonText;
        } else {
            ele.style.display = "block";
            text.innerHTML = "Hide: " + buttonText;
        }
    } 
</script>

<script language="javascript">
    function openCode(evt, codeName, id) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent" + id);
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks" + id);
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(codeName).style.display = "block";
        evt.currentTarget.className += " active";
    }
</script>

<script language="javascript">
    function hide(id){
        document.getElementById(id).style.display = "none";
    }
</script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Opening</a></li>
<li class="chapter" data-level="2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html"><i class="fa fa-check"></i><b>2</b> Programming Practical - P1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#getting-started"><i class="fa fa-check"></i><b>2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#predicting-the-behaviour-of-for-loops"><i class="fa fa-check"></i><b>2.2</b> Predicting the behaviour of for loops</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#example-one"><i class="fa fa-check"></i><b>2.2.1</b> Example one</a></li>
<li class="chapter" data-level="2.2.2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#example-two"><i class="fa fa-check"></i><b>2.2.2</b> Example two</a></li>
<li class="chapter" data-level="2.2.3" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#example-three"><i class="fa fa-check"></i><b>2.2.3</b> Example three</a></li>
<li class="chapter" data-level="2.2.4" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#example-four"><i class="fa fa-check"></i><b>2.2.4</b> Example four</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#writing-a-for-loop"><i class="fa fa-check"></i><b>2.3</b> Writing a for loop</a></li>
<li class="chapter" data-level="2.4" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#writing-a-while-loop"><i class="fa fa-check"></i><b>2.4</b> Writing a while loop</a></li>
<li class="chapter" data-level="2.5" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#using-loops-to-do-more-complex-calculations"><i class="fa fa-check"></i><b>2.5</b> Using loops to do more complex calculations</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#a-loop-for-which-the-number-of-iterations-is-known-in-advance"><i class="fa fa-check"></i><b>2.5.1</b> A loop for which the number of iterations is known in advance</a></li>
<li class="chapter" data-level="2.5.2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#a-loop-for-which-the-number-of-iterations-is-not-know-in-advance"><i class="fa fa-check"></i><b>2.5.2</b> A loop for which the number of iterations is not know in advance</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#writing-simple-functions"><i class="fa fa-check"></i><b>2.6</b> Writing simple functions</a></li>
<li class="chapter" data-level="2.7" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#predicting-the-behaviour-of-a-function"><i class="fa fa-check"></i><b>2.7</b> Predicting the behaviour of a function</a></li>
<li class="chapter" data-level="2.8" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#return-values-from-functions"><i class="fa fa-check"></i><b>2.8</b> Return values from functions</a></li>
<li class="chapter" data-level="2.9" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#additional-tasks-for-those-with-programming-experience"><i class="fa fa-check"></i><b>2.9</b> Additional tasks for those with programming experience</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#extended-example-one-monte-carlo-simulation"><i class="fa fa-check"></i><b>2.9.1</b> Extended example one: Monte Carlo simulation</a></li>
<li class="chapter" data-level="2.9.2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#extended-example-two-the-logistic-map"><i class="fa fa-check"></i><b>2.9.2</b> Extended example two: the logistic map</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#appendix-relating-sticker-collecting-to-the-harmonic-numbers"><i class="fa fa-check"></i><b>2.10</b> Appendix: relating sticker collecting to the harmonic numbers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html"><i class="fa fa-check"></i><b>3</b> Programming Practical - P2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#random-variables"><i class="fa fa-check"></i><b>3.1</b> Random variables</a></li>
<li class="chapter" data-level="3.2" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#probability-distributions"><i class="fa fa-check"></i><b>3.2</b> Probability distributions</a></li>
<li class="chapter" data-level="3.3" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#using-probability-distributions-in-r---types"><i class="fa fa-check"></i><b>3.3</b> Using probability distributions in R - types</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#ddist"><i class="fa fa-check"></i><b>3.3.1</b> <code>ddist()</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#pdist"><i class="fa fa-check"></i><b>3.3.2</b> <code>pdist()</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#rdist"><i class="fa fa-check"></i><b>3.3.3</b> <code>rdist()</code></a></li>
<li class="chapter" data-level="3.3.4" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#rnorm---normal-distribution"><i class="fa fa-check"></i><b>3.3.4</b> <code>rnorm()</code> - Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#example-one---using-probabilities-for-simulation"><i class="fa fa-check"></i><b>3.4</b> Example one - using probabilities for simulation</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#binomial-distribution"><i class="fa fa-check"></i><b>3.4.1</b> Binomial Distribution</a></li>
<li class="chapter" data-level="3.4.2" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#normal-distribution"><i class="fa fa-check"></i><b>3.4.2</b> Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#example-two---multiple-choices"><i class="fa fa-check"></i><b>3.5</b> Example two - multiple choices</a></li>
<li class="chapter" data-level="3.6" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#exercise-one---using-r-to-model-a-die"><i class="fa fa-check"></i><b>3.6</b> Exercise one - using R to model a die</a></li>
<li class="chapter" data-level="3.7" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#example-three---using-r-to-model-a-death-process-stochastically"><i class="fa fa-check"></i><b>3.7</b> Example three - using R to model a death process stochastically</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html"><i class="fa fa-check"></i><b>4</b> Dynamic models Practical</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html#introduction-to-desolve"><i class="fa fa-check"></i><b>4.1</b> Introduction to deSolve</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html#a-bit-of-theory"><i class="fa fa-check"></i><b>4.1.1</b> A bit of theory</a></li>
<li class="chapter" data-level="4.1.2" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html#the-return-of-the-logistic-model"><i class="fa fa-check"></i><b>4.1.2</b> The return of the logistic model</a></li>
<li class="chapter" data-level="4.1.3" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html#the-revenge-of-the-amoeba"><i class="fa fa-check"></i><b>4.1.3</b> The revenge of the amoeba</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html"><i class="fa fa-check"></i><b>5</b> Epidemic models - P1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#the-basic-sir-model"><i class="fa fa-check"></i><b>5.1</b> The basic SIR model</a></li>
<li class="chapter" data-level="5.2" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#coding-the-model"><i class="fa fa-check"></i><b>5.2</b> Coding the model</a></li>
<li class="chapter" data-level="5.3" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#some-properties-of-the-model"><i class="fa fa-check"></i><b>5.3</b> Some properties of the model</a></li>
<li class="chapter" data-level="5.4" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#calculating-the-infectious-period"><i class="fa fa-check"></i><b>5.4</b> Calculating the infectious period</a></li>
<li class="chapter" data-level="5.5" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#optional-section---extending-sir-to-other-compartments"><i class="fa fa-check"></i><b>5.5</b> Optional section - extending SIR to other compartments</a></li>
<li class="chapter" data-level="5.6" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#appendeix---epidemic-peak-and-final-epidemic-size"><i class="fa fa-check"></i><b>5.6</b> Appendeix - Epidemic peak and final epidemic size</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="epidemic-models---p2.html"><a href="epidemic-models---p2.html"><i class="fa fa-check"></i><b>6</b> Epidemic models - P2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="epidemic-models---p2.html"><a href="epidemic-models---p2.html#calculating-r_0"><i class="fa fa-check"></i><b>6.1</b> Calculating <span class="math inline">\(R_{0}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html"><i class="fa fa-check"></i><b>7</b> Epidemic models - P3</a>
<ul>
<li class="chapter" data-level="7.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#coding-a-simple-si-model"><i class="fa fa-check"></i><b>7.1</b> Coding a simple SI model</a></li>
<li class="chapter" data-level="7.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#dissecting-the-stochastic-si-code"><i class="fa fa-check"></i><b>7.2</b> Dissecting the stochastic SI code</a></li>
<li class="chapter" data-level="7.3" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#performing-multiple-simulations"><i class="fa fa-check"></i><b>7.3</b> Performing Multiple Simulations</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#adding-the-deterministic-solution-curve"><i class="fa fa-check"></i><b>7.3.1</b> Adding the deterministic solution curve</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exploring-the-effects-of-stochasticity"><i class="fa fa-check"></i><b>7.4</b> Exploring the effects of Stochasticity</a></li>
<li class="chapter" data-level="7.5" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#the-delay-time"><i class="fa fa-check"></i><b>7.5</b> The delay time</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#the-deterministic-half-time"><i class="fa fa-check"></i><b>7.5.1</b> The deterministic half-time</a></li>
<li class="chapter" data-level="7.5.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#the-stochastic-half-time"><i class="fa fa-check"></i><b>7.5.2</b> The stochastic half-time</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#coding-a-simple-sir-model"><i class="fa fa-check"></i><b>7.6</b> Coding a simple SIR model</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-one"><i class="fa fa-check"></i><b>7.6.1</b> Exercise one</a></li>
<li class="chapter" data-level="7.6.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-two"><i class="fa fa-check"></i><b>7.6.2</b> Exercise two</a></li>
<li class="chapter" data-level="7.6.3" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-three"><i class="fa fa-check"></i><b>7.6.3</b> Exercise three</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#sis-extension-adding-recovery-from-infection"><i class="fa fa-check"></i><b>7.7</b> SIS Extension: Adding Recovery from Infection</a></li>
<li class="chapter" data-level="7.8" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#sis-extension-adding-host-demography"><i class="fa fa-check"></i><b>7.8</b> SIS Extension: Adding host demography</a></li>
<li class="chapter" data-level="7.9" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#sir-extension-the-final-epidemic-size"><i class="fa fa-check"></i><b>7.9</b> SIR Extension: The final epidemic size</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-one-1"><i class="fa fa-check"></i><b>7.9.1</b> Exercise one</a></li>
<li class="chapter" data-level="7.9.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-two-1"><i class="fa fa-check"></i><b>7.9.2</b> Exercise two</a></li>
<li class="chapter" data-level="7.9.3" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-three-1"><i class="fa fa-check"></i><b>7.9.3</b> Exercise three</a></li>
<li class="chapter" data-level="7.9.4" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-four"><i class="fa fa-check"></i><b>7.9.4</b> Exercise four</a></li>
<li class="chapter" data-level="7.9.5" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-five"><i class="fa fa-check"></i><b>7.9.5</b> Exercise five</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#sir-extension-stochastic-extinction"><i class="fa fa-check"></i><b>7.10</b> SIR Extension: Stochastic extinction</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#question"><i class="fa fa-check"></i><b>7.10.1</b> Question</a></li>
<li class="chapter" data-level="7.10.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-one-2"><i class="fa fa-check"></i><b>7.10.2</b> Exercise one</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html"><i class="fa fa-check"></i><b>8</b> Estimating <span class="math inline">\(R_{0}\)</span> - P1</a>
<ul>
<li class="chapter" data-level="8.1" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#introduction-models-and-data-sets"><i class="fa fa-check"></i><b>8.1</b> Introduction: Models and Data sets</a></li>
<li class="chapter" data-level="8.2" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#final-size-method"><i class="fa fa-check"></i><b>8.2</b> Final Size Method</a></li>
<li class="chapter" data-level="8.3" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#regression-method"><i class="fa fa-check"></i><b>8.3</b> Regression Method</a></li>
<li class="chapter" data-level="8.4" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#recon-earlyr-method"><i class="fa fa-check"></i><b>8.4</b> RECON earlyR method</a></li>
<li class="chapter" data-level="8.5" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#appendix"><i class="fa fa-check"></i><b>8.5</b> Appendix</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html"><i class="fa fa-check"></i><b>9</b> Seasonality and Measles Epidemics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html#measles-data-and-challenge"><i class="fa fa-check"></i><b>9.1</b> Measles data and challenge</a></li>
<li class="chapter" data-level="9.2" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html#standard-seir-exponential-with-sinusoidal-forcing"><i class="fa fa-check"></i><b>9.2</b> Standard SEIR (exponential) with sinusoidal forcing</a></li>
<li class="chapter" data-level="9.3" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html#standard-seir-exponential-with-term-time-forcing"><i class="fa fa-check"></i><b>9.3</b> Standard SEIR (exponential) with term-time forcing</a></li>
<li class="chapter" data-level="9.4" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html#gamma-seir-with-term-time-forcing"><i class="fa fa-check"></i><b>9.4</b> Gamma SEIR with term-time forcing</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="outbreak-of-influenza-in-a-boarding-school.html"><a href="outbreak-of-influenza-in-a-boarding-school.html"><i class="fa fa-check"></i><b>10</b> Outbreak of influenza in a boarding school</a>
<ul>
<li class="chapter" data-level="10.1" data-path="outbreak-of-influenza-in-a-boarding-school.html"><a href="outbreak-of-influenza-in-a-boarding-school.html#data-summary-and-challenge"><i class="fa fa-check"></i><b>10.1</b> Data Summary and challenge</a></li>
<li class="chapter" data-level="10.2" data-path="outbreak-of-influenza-in-a-boarding-school.html"><a href="outbreak-of-influenza-in-a-boarding-school.html#deterministic-model"><i class="fa fa-check"></i><b>10.2</b> Deterministic model</a></li>
<li class="chapter" data-level="10.3" data-path="outbreak-of-influenza-in-a-boarding-school.html"><a href="outbreak-of-influenza-in-a-boarding-school.html#stochastic-model"><i class="fa fa-check"></i><b>10.3</b> Stochastic model</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-Practical</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="programming-practical---p1" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Programming Practical - P1<a href="programming-practical---p1.html#programming-practical---p1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="getting-started" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Getting started<a href="programming-practical---p1.html#getting-started" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Start a new RStudio session, set your current working directory, open a new R Script and save this (blank) script to a file with an appropriate name.</p>
<p>Use this script file to edit and keep copies of the code you write in this practical: you may find it useful be able to look back later.</p>
</div>
<div id="predicting-the-behaviour-of-for-loops" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Predicting the behaviour of for loops<a href="programming-practical---p1.html#predicting-the-behaviour-of-for-loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will use R to generate some data in the form of vectors and use these data to form some looping constructs. Predicting what code will do and testing your predictions by running the code should help cement your understanding of for loops.</p>
<p>Type the following code into your script. Remember that code after # is a comment and will be ignored by the R interpreter (you do not have to type these comments in for yourself, but you might want to if you think you will need to refer to them later).</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="programming-practical---p1.html#cb1-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>           <span class="co"># Assign the integers 1 to 10 in order to the vector a</span></span>
<span id="cb1-2"><a href="programming-practical---p1.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)            <span class="co"># Print a to the screen</span></span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="programming-practical---p1.html#cb3-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">sample</span>(a)      <span class="co"># Set b to be a with elements shuffled into random order</span></span>
<span id="cb3-2"><a href="programming-practical---p1.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b)            <span class="co"># Print b to the screen</span></span></code></pre></div>
<pre><code>##  [1]  1 10  3  2  4  7  6  5  9  8</code></pre>
</div>
</div>
<p>Run the code a few times either by sourcing it or by highlighting it in the script then pressing the run button in RStudio.</p>
<p>You should note that:</p>
<ul>
<li>The first line creates a new vector a with the elements 1 to 10 in order</li>
<li>The second line prints the vector a to the screen</li>
<li>The third line uses a built-in R function to sample (all of) the elements of the vector a without replacement, i.e., to permute the elements into a different order, and assigns the result to the vector b</li>
<li>The fourth line prints the vector b</li>
</ul>
<div id="example-one" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Example one<a href="programming-practical---p1.html#example-one" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write down what you expect the output of the following code to be before verifying your answer by entering the code into your script and running it.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="programming-practical---p1.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb5-2"><a href="programming-practical---p1.html#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(i, a[i]))</span>
<span id="cb5-3"><a href="programming-practical---p1.html#cb5-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<button id="displayTextunnamed-chunk-4" onclick="javascript:toggle(&#39;unnamed-chunk-4&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-4" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<p>Prints numbers in order.</p>
<pre><code>## [1] &quot;1 1&quot;
## [1] &quot;2 2&quot;
## [1] &quot;3 3&quot;
## [1] &quot;4 4&quot;
## [1] &quot;5 5&quot;
## [1] &quot;6 6&quot;
## [1] &quot;7 7&quot;
## [1] &quot;8 8&quot;
## [1] &quot;9 9&quot;
## [1] &quot;10 10&quot;</code></pre>
</div>
</div>
</div>
</div>
<div id="example-two" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Example two<a href="programming-practical---p1.html#example-two" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write down what you expect the output of the following code to be before verifying your answer by entering the code into your script and running it.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="programming-practical---p1.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb7-2"><a href="programming-practical---p1.html#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(i, b[i]))</span>
<span id="cb7-3"><a href="programming-practical---p1.html#cb7-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<button id="displayTextunnamed-chunk-6" onclick="javascript:toggle(&#39;unnamed-chunk-6&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-6" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<p>Prints numbers in reverse order according to whatever is in sample b.</p>
<pre><code>## [1] &quot;1 1&quot;
## [1] &quot;2 10&quot;
## [1] &quot;3 3&quot;
## [1] &quot;4 2&quot;
## [1] &quot;5 4&quot;
## [1] &quot;6 7&quot;
## [1] &quot;7 6&quot;
## [1] &quot;8 5&quot;
## [1] &quot;9 9&quot;
## [1] &quot;10 8&quot;</code></pre>
</div>
</div>
</div>
</div>
<div id="example-three" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Example three<a href="programming-practical---p1.html#example-three" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write down what you expect the output of the following code to be before verifying your answer by entering the code into your script and running it.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="programming-practical---p1.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> a) {</span>
<span id="cb9-2"><a href="programming-practical---p1.html#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(i, b[i]))</span>
<span id="cb9-3"><a href="programming-practical---p1.html#cb9-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<button id="displayTextunnamed-chunk-8" onclick="javascript:toggle(&#39;unnamed-chunk-8&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-8" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<p>Prints numbers in forward order according to whatever is in sample b.</p>
<pre><code>## [1] &quot;1 1&quot;
## [1] &quot;2 10&quot;
## [1] &quot;3 3&quot;
## [1] &quot;4 2&quot;
## [1] &quot;5 4&quot;
## [1] &quot;6 7&quot;
## [1] &quot;7 6&quot;
## [1] &quot;8 5&quot;
## [1] &quot;9 9&quot;
## [1] &quot;10 8&quot;</code></pre>
</div>
</div>
</div>
</div>
<div id="example-four" class="section level3 hasAnchor" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Example four<a href="programming-practical---p1.html#example-four" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write down what you expect the output of the following code to be before verifying your answer by entering the code into your script and running it.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="programming-practical---p1.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">sample</span>(a)) {</span>
<span id="cb11-2"><a href="programming-practical---p1.html#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(i, b[i]))</span>
<span id="cb11-3"><a href="programming-practical---p1.html#cb11-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<button id="displayTextunnamed-chunk-10" onclick="javascript:toggle(&#39;unnamed-chunk-10&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-10" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<p>Prints numbers in random order from whatever is in sample b.</p>
<pre><code>## [1] &quot;7 6&quot;
## [1] &quot;8 5&quot;
## [1] &quot;6 7&quot;
## [1] &quot;5 4&quot;
## [1] &quot;4 2&quot;
## [1] &quot;10 8&quot;
## [1] &quot;1 1&quot;
## [1] &quot;9 9&quot;
## [1] &quot;3 3&quot;
## [1] &quot;2 10&quot;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="writing-a-for-loop" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Writing a for loop<a href="programming-practical---p1.html#writing-a-for-loop" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Adapt the code from the lecture to use a for loop to do the following:</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<p>Print the 12 times table, i.e. produce output of the form</p>
<p>1 times 12 is 12</p>
<p>2 times 12 is 24</p>
<p>…</p>
12 times 12 is 144
</div>
</div>
<button id="displayTextunnamed-chunk-12" onclick="javascript:toggle(&#39;unnamed-chunk-12&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-12" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="programming-practical---p1.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) {</span>
<span id="cb13-2"><a href="programming-practical---p1.html#cb13-2" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">&lt;-</span> i <span class="sc">*</span> <span class="dv">12</span></span>
<span id="cb13-3"><a href="programming-practical---p1.html#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(i, <span class="st">&quot;times 12 is&quot;</span>, result))</span>
<span id="cb13-4"><a href="programming-practical---p1.html#cb13-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;1 times 12 is 12&quot;
## [1] &quot;2 times 12 is 24&quot;
## [1] &quot;3 times 12 is 36&quot;
## [1] &quot;4 times 12 is 48&quot;
## [1] &quot;5 times 12 is 60&quot;
## [1] &quot;6 times 12 is 72&quot;
## [1] &quot;7 times 12 is 84&quot;
## [1] &quot;8 times 12 is 96&quot;
## [1] &quot;9 times 12 is 108&quot;
## [1] &quot;10 times 12 is 120&quot;
## [1] &quot;11 times 12 is 132&quot;
## [1] &quot;12 times 12 is 144&quot;</code></pre>
</div>
</div>
</div>
</div>
<div id="writing-a-while-loop" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Writing a while loop<a href="programming-practical---p1.html#writing-a-while-loop" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Repeat the previous task using a while loop.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<p>Print the 12 times table, i.e. produce output of the form</p>
<p>1 times 12 is 12</p>
<p>2 times 12 is 24</p>
<p>…</p>
12 times 12 is 144
</div>
</div>
<button id="displayTextunnamed-chunk-14" onclick="javascript:toggle(&#39;unnamed-chunk-14&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-14" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="programming-practical---p1.html#cb15-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-2"><a href="programming-practical---p1.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(i <span class="sc">&lt;=</span> <span class="dv">12</span>) {</span>
<span id="cb15-3"><a href="programming-practical---p1.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> i <span class="sc">*</span> <span class="dv">12</span></span>
<span id="cb15-4"><a href="programming-practical---p1.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(i, <span class="st">&quot;times 12 is&quot;</span>, result))</span>
<span id="cb15-5"><a href="programming-practical---p1.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-6"><a href="programming-practical---p1.html#cb15-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;1 times 12 is 12&quot;
## [1] &quot;2 times 12 is 24&quot;
## [1] &quot;3 times 12 is 36&quot;
## [1] &quot;4 times 12 is 48&quot;
## [1] &quot;5 times 12 is 60&quot;
## [1] &quot;6 times 12 is 72&quot;
## [1] &quot;7 times 12 is 84&quot;
## [1] &quot;8 times 12 is 96&quot;
## [1] &quot;9 times 12 is 108&quot;
## [1] &quot;10 times 12 is 120&quot;
## [1] &quot;11 times 12 is 132&quot;
## [1] &quot;12 times 12 is 144&quot;</code></pre>
</div>
</div>
</div>
</div>
<div id="using-loops-to-do-more-complex-calculations" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Using loops to do more complex calculations<a href="programming-practical---p1.html#using-loops-to-do-more-complex-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="a-loop-for-which-the-number-of-iterations-is-known-in-advance" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> A loop for which the number of iterations is known in advance<a href="programming-practical---p1.html#a-loop-for-which-the-number-of-iterations-is-known-in-advance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Enter the following code to your script and check you understand the output.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="programming-practical---p1.html#cb17-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb17-2"><a href="programming-practical---p1.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="dv">2</span><span class="sc">^</span>p)</span>
<span id="cb17-3"><a href="programming-practical---p1.html#cb17-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb17-4"><a href="programming-practical---p1.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p<span class="sc">^</span><span class="dv">3</span>)</span></code></pre></div>
<p>Now write code to answer the following question.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
What is the sum of the first 15 powers of 2 (i.e. 2<sup>1</sup> + 2<sup>2</sup> + … 2<sup>15</sup>)?
</div>
</div>
<button id="displayTextunnamed-chunk-17" onclick="javascript:toggle(&#39;unnamed-chunk-17&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-17" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="programming-practical---p1.html#cb18-1" aria-hidden="true" tabindex="-1"></a>runningSum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb18-2"><a href="programming-practical---p1.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>) {</span>
<span id="cb18-3"><a href="programming-practical---p1.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  runningSum <span class="ot">&lt;-</span> runningSum <span class="sc">+</span> <span class="dv">2</span><span class="sc">^</span>i</span>
<span id="cb18-4"><a href="programming-practical---p1.html#cb18-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-5"><a href="programming-practical---p1.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Sum is&quot;</span>,runningSum))</span></code></pre></div>
<pre><code>## [1] &quot;Sum is 65534&quot;</code></pre>
<p>Note you can do the above more efficiently, e.g. <code>sum(2^(1:15))</code></p>
</div>
</div>
</div>
</div>
<div id="a-loop-for-which-the-number-of-iterations-is-not-know-in-advance" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> A loop for which the number of iterations is not know in advance<a href="programming-practical---p1.html#a-loop-for-which-the-number-of-iterations-is-not-know-in-advance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Write code to answer the following question.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
What is the smallest power of 2 that is greater than 1000000?
</div>
</div>
<button id="displayTextunnamed-chunk-19" onclick="javascript:toggle(&#39;unnamed-chunk-19&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-19" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="programming-practical---p1.html#cb20-1" aria-hidden="true" tabindex="-1"></a>thisIDX <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-2"><a href="programming-practical---p1.html#cb20-2" aria-hidden="true" tabindex="-1"></a>thisPower <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>thisIDX</span>
<span id="cb20-3"><a href="programming-practical---p1.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(thisPower<span class="sc">&lt;</span><span class="dv">1000000</span>) {</span>
<span id="cb20-4"><a href="programming-practical---p1.html#cb20-4" aria-hidden="true" tabindex="-1"></a>  thisIDX <span class="ot">&lt;-</span> thisIDX <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb20-5"><a href="programming-practical---p1.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  thisPower <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span>thisIDX</span>
<span id="cb20-6"><a href="programming-practical---p1.html#cb20-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-7"><a href="programming-practical---p1.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;2^&quot;</span>,thisIDX,<span class="st">&quot;=&quot;</span>,thisPower,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;2^20=1048576&quot;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="writing-simple-functions" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Writing simple functions<a href="programming-practical---p1.html#writing-simple-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Type the following code into your script and run it.</p>
<p>Before you run it, think about whether you expect any output.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="programming-practical---p1.html#cb22-1" aria-hidden="true" tabindex="-1"></a>sayHello <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb22-2"><a href="programming-practical---p1.html#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Hello&quot;</span>)</span>
<span id="cb22-3"><a href="programming-practical---p1.html#cb22-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Type the following at the command prompt, but before you do so, predict what will happen.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="programming-practical---p1.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHello</span>()</span></code></pre></div>
<p>Now type the following code into your script.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="programming-practical---p1.html#cb24-1" aria-hidden="true" tabindex="-1"></a>sayHelloWithArg <span class="ot">&lt;-</span> <span class="cf">function</span>(whoTo) {</span>
<span id="cb24-2"><a href="programming-practical---p1.html#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Hello&quot;</span>, whoTo))</span>
<span id="cb24-3"><a href="programming-practical---p1.html#cb24-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<p>Now type each of the following instructions into the command prompt.</p>
<p>Before typing each line, predict what will happen.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="programming-practical---p1.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>()</span>
<span id="cb25-2"><a href="programming-practical---p1.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="programming-practical---p1.html#cb25-3" aria-hidden="true" tabindex="-1"></a>sayHelloWithArg </span>
<span id="cb25-4"><a href="programming-practical---p1.html#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="programming-practical---p1.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>(<span class="st">&quot;nik&quot;</span>)</span>
<span id="cb25-6"><a href="programming-practical---p1.html#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="programming-practical---p1.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHello</span>(<span class="st">&quot;nik&quot;</span>)</span>
<span id="cb25-8"><a href="programming-practical---p1.html#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="programming-practical---p1.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>(nik) </span>
<span id="cb25-10"><a href="programming-practical---p1.html#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="programming-practical---p1.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>(<span class="at">whoto=</span><span class="st">&quot;nik&quot;</span>) </span>
<span id="cb25-12"><a href="programming-practical---p1.html#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="programming-practical---p1.html#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>(<span class="at">whoTo=</span><span class="st">&quot;nik&quot;</span>)</span></code></pre></div>
</div>
</div>
<button id="displayTextunnamed-chunk-24" onclick="javascript:toggle(&#39;unnamed-chunk-24&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-24" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="programming-practical---p1.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>()       <span class="co"># error, since not passed argument</span></span>
<span id="cb26-2"><a href="programming-practical---p1.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="programming-practical---p1.html#cb26-3" aria-hidden="true" tabindex="-1"></a>sayHelloWithArg         <span class="co"># echos function&#39;s code to screen (happens in general if type function&#39;s name without brackets)</span></span>
<span id="cb26-4"><a href="programming-practical---p1.html#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="programming-practical---p1.html#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>(<span class="st">&quot;nik&quot;</span>)  <span class="co"># works as expected</span></span>
<span id="cb26-6"><a href="programming-practical---p1.html#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="programming-practical---p1.html#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHello</span>(<span class="st">&quot;nik&quot;</span>)         <span class="co"># error, since too many arguments for the simpler function</span></span>
<span id="cb26-8"><a href="programming-practical---p1.html#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="programming-practical---p1.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>(nik)    <span class="co"># error, since variable nik is not defined</span></span>
<span id="cb26-10"><a href="programming-practical---p1.html#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="programming-practical---p1.html#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>(<span class="at">whoto=</span><span class="st">&quot;nik&quot;</span>) <span class="co"># error, since argument names are case sensitive</span></span>
<span id="cb26-12"><a href="programming-practical---p1.html#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="programming-practical---p1.html#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sayHelloWithArg</span>(<span class="at">whoTo=</span><span class="st">&quot;nik&quot;</span>) <span class="co"># works as expected</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="predicting-the-behaviour-of-a-function" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Predicting the behaviour of a function<a href="programming-practical---p1.html#predicting-the-behaviour-of-a-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For now, do not type in the following code, but instead just read it.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="programming-practical---p1.html#cb27-1" aria-hidden="true" tabindex="-1"></a>cat <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb27-2"><a href="programming-practical---p1.html#cb27-2" aria-hidden="true" tabindex="-1"></a>canary <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb27-3"><a href="programming-practical---p1.html#cb27-3" aria-hidden="true" tabindex="-1"></a>buster <span class="ot">&lt;-</span> <span class="cf">function</span>(cat, canary) { </span>
<span id="cb27-4"><a href="programming-practical---p1.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  cat <span class="ot">&lt;-</span> cat<span class="sc">*</span><span class="dv">2</span> </span>
<span id="cb27-5"><a href="programming-practical---p1.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  canary <span class="ot">&lt;-</span> canary<span class="sc">*</span><span class="dv">3</span></span>
<span id="cb27-6"><a href="programming-practical---p1.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(cat <span class="sc">+</span> canary) </span>
<span id="cb27-7"><a href="programming-practical---p1.html#cb27-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-8"><a href="programming-practical---p1.html#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="programming-practical---p1.html#cb27-9" aria-hidden="true" tabindex="-1"></a>ghost <span class="ot">=</span> <span class="fu">buster</span>(canary, <span class="sc">-</span>cat)</span></code></pre></div>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
Think carefully about what you expect the values of cat, canary and ghost to be after this code is executed and write down your answer.
</div>
</div>
<p>Now execute the code and test your prediction.</p>
<button id="displayTextunnamed-chunk-27" onclick="javascript:toggle(&#39;unnamed-chunk-27&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-27" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
The line <code>ghost = buster(canary, -cat)</code> sets ghost to be 2, but leaves cat and canary unchanged.
</div>
</div>
</div>
</div>
<div id="return-values-from-functions" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Return values from functions<a href="programming-practical---p1.html#return-values-from-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The code in the box below does the following.</p>
<ul>
<li>Defines a function <code>mySum</code> that returns the sum of a vector</li>
<li>Creates a vector <code>x</code> containing 100 uniform random numbers between 0 and 1</li>
<li>Finds their sum using <code>mySum</code></li>
<li>Finds their sum using the built-in R function <code>sum</code></li>
<li>Prints out a comparison of the two values</li>
</ul>
<p>Type the code into your script and make sure you are happy with how it works.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="programming-practical---p1.html#cb28-1" aria-hidden="true" tabindex="-1"></a>mySum <span class="ot">&lt;-</span> <span class="cf">function</span>(toSum) { <span class="co"># my function to sum elements of a vector</span></span>
<span id="cb28-2"><a href="programming-practical---p1.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  retVal <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-3"><a href="programming-practical---p1.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(toSum))</span>
<span id="cb28-4"><a href="programming-practical---p1.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb28-5"><a href="programming-practical---p1.html#cb28-5" aria-hidden="true" tabindex="-1"></a>    retVal <span class="ot">&lt;-</span> retVal <span class="sc">+</span> toSum[i]  </span>
<span id="cb28-6"><a href="programming-practical---p1.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb28-7"><a href="programming-practical---p1.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(retVal)</span>
<span id="cb28-8"><a href="programming-practical---p1.html#cb28-8" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb28-9"><a href="programming-practical---p1.html#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="programming-practical---p1.html#cb28-10" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)     <span class="co"># generate 100 uniform random numbers </span></span>
<span id="cb28-11"><a href="programming-practical---p1.html#cb28-11" aria-hidden="true" tabindex="-1"></a>myWay <span class="ot">&lt;-</span> <span class="fu">mySum</span>(a)   <span class="co"># calculate sum using our mySum() function</span></span>
<span id="cb28-12"><a href="programming-practical---p1.html#cb28-12" aria-hidden="true" tabindex="-1"></a>rWay <span class="ot">&lt;-</span> <span class="fu">sum</span>(a)      <span class="co"># calculate sum using built-in sum() function </span></span>
<span id="cb28-13"><a href="programming-practical---p1.html#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;My answer&quot;</span>, myWay, <span class="st">&quot;... R answer&quot;</span>, rWay))</span></code></pre></div>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<p>Use the function <code>mySum</code> as a base to write a new function <code>mySumAndMean</code>.</p>
The new function should calculate the sum and the mean of whatever vector it receives as an input. It should return a vector: the first element of the output vector should be the sum, the second the mean. You might find the built-in function mean helpful to test your code.
</div>
</div>
<button id="displayTextunnamed-chunk-30" onclick="javascript:toggle(&#39;unnamed-chunk-30&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-30" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="programming-practical---p1.html#cb29-1" aria-hidden="true" tabindex="-1"></a>mySumAndMean <span class="ot">&lt;-</span> <span class="cf">function</span>(toSum) { <span class="co"># my function to sum elements of a vector and return that and the mean</span></span>
<span id="cb29-2"><a href="programming-practical---p1.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  retVal <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-3"><a href="programming-practical---p1.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(toSum))</span>
<span id="cb29-4"><a href="programming-practical---p1.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb29-5"><a href="programming-practical---p1.html#cb29-5" aria-hidden="true" tabindex="-1"></a>    retVal <span class="ot">&lt;-</span> retVal <span class="sc">+</span> toSum[i]  </span>
<span id="cb29-6"><a href="programming-practical---p1.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb29-7"><a href="programming-practical---p1.html#cb29-7" aria-hidden="true" tabindex="-1"></a>  meanVal <span class="ot">&lt;-</span> retVal<span class="sc">/</span><span class="fu">length</span>(toSum) <span class="co"># find the mean, too</span></span>
<span id="cb29-8"><a href="programming-practical---p1.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(retVal,meanVal))       <span class="co"># return two values by wrapping up into vector</span></span>
<span id="cb29-9"><a href="programming-practical---p1.html#cb29-9" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="additional-tasks-for-those-with-programming-experience" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Additional tasks for those with programming experience<a href="programming-practical---p1.html#additional-tasks-for-those-with-programming-experience" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following tasks are mainly aimed at those of you who already have experience in programming.</p>
<div id="extended-example-one-monte-carlo-simulation" class="section level3 hasAnchor" number="2.9.1">
<h3><span class="header-section-number">2.9.1</span> Extended example one: Monte Carlo simulation<a href="programming-practical---p1.html#extended-example-one-monte-carlo-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When I was younger, I sometimes collected Panini football stickers.</p>
<p>The basic idea is very simple: you collect numbered stickers to stick into an album, continuing to buy stickers until you have the full set. The problem is that you don’t know which stickers you are going to get until you open a packet. Each packet contains a random sample of the available stickers, and packets are sealed at the time of purchase. This means that as you get closer and closer to completing the album, it becomes more and more unlikely that any new packet will contain any stickers you need for your album.</p>
<p>At the time, it was a matter of significant regret for me that I never did complete the album for the Mexico ’86 World Cup. That album required a total of 427 stickers.</p>
<p>Now, better trained in mathematics and computing, I wondered how many stickers I might have had to buy to be successful in my quest to complete the album.</p>
<p>We are going to write a simple “Monte Carlo” simulation to understand this. Monte Carlo simulations rely on random sampling to obtain an estimate of a random variable. You will be writing Monte Carlo simulations of stochastic epidemic models later in the course, so this is good practice.</p>
<p>We remove some of the complexity by considering a slightly simpler situation, in which stickers come in packets of one.</p>
<p>Note the built-in R function <code>sample</code> that was introduced earlier can in fact be called in other ways. Type the following into the command line and run it a few times</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="programming-practical---p1.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="dv">3</span>)</span></code></pre></div>
<p>You should see that – when it is called with two arguments – the built-in R function <code>sample</code> no longer merely shuffles the whole of the vector that is its first argument, but instead randomly samples the number of elements given by the second argument from that vector (again without replacement). The above corresponds to randomly choosing a three numbers from the list of integers between 1 and 200.</p>
<p>Furthermore, note the behaviour of the built-in R function <code>rep</code> by typing the following in at the command line</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="programming-practical---p1.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="cn">TRUE</span>,<span class="dv">4</span>)</span></code></pre></div>
<p>You should see that this line of code creates a vector of length 4 where all four elements are the logical value <code>TRUE</code>.</p>
<p>One way of writing a simulation of a single attempt to collect the entire album would be something like the code that follows. <strong>However, this code contains a deliberate mistake.</strong></p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<p>Enter the code into your script, find the mistake, fix it, and run the code.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="programming-practical---p1.html#cb32-1" aria-hidden="true" tabindex="-1"></a>totStickers <span class="ot">&lt;-</span> <span class="dv">427</span></span>
<span id="cb32-2"><a href="programming-practical---p1.html#cb32-2" aria-hidden="true" tabindex="-1"></a>gotSticker <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>,totStickers)</span>
<span id="cb32-3"><a href="programming-practical---p1.html#cb32-3" aria-hidden="true" tabindex="-1"></a>numLeft <span class="ot">&lt;-</span> totStickers</span>
<span id="cb32-4"><a href="programming-practical---p1.html#cb32-4" aria-hidden="true" tabindex="-1"></a>numStickersBought <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-5"><a href="programming-practical---p1.html#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(numLeft <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb32-6"><a href="programming-practical---p1.html#cb32-6" aria-hidden="true" tabindex="-1"></a>  numStickersBought <span class="ot">&lt;-</span> numStickersBought <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb32-7"><a href="programming-practical---p1.html#cb32-7" aria-hidden="true" tabindex="-1"></a>  thisSticker <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>totStickers,<span class="dv">1</span>)</span>
<span id="cb32-8"><a href="programming-practical---p1.html#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(gotSticker[thisSticker]<span class="sc">==</span><span class="cn">TRUE</span>) {</span>
<span id="cb32-9"><a href="programming-practical---p1.html#cb32-9" aria-hidden="true" tabindex="-1"></a>    gotSticker[thisSticker] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb32-10"><a href="programming-practical---p1.html#cb32-10" aria-hidden="true" tabindex="-1"></a>    numLeft <span class="ot">&lt;-</span> numLeft <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb32-11"><a href="programming-practical---p1.html#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;got&#39;</span>, thisSticker, <span class="st">&#39;still need&#39;</span>,numLeft))</span>
<span id="cb32-12"><a href="programming-practical---p1.html#cb32-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-13"><a href="programming-practical---p1.html#cb32-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-14"><a href="programming-practical---p1.html#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;bought&#39;</span>, numStickersBought))</span></code></pre></div>
</div>
</div>
<button id="displayTextunnamed-chunk-34" onclick="javascript:toggle(&#39;unnamed-chunk-34&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-34" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<p>There is a mistake in the code on line 8. The condition in the <code>if</code> statement should be checking for <code>FALSE</code>, not <code>TRUE</code>.</p>
</div>
</div>
</div>
<p>Each time you run the fixed version of the code should lead to a different result. You can get an estimate of the average number of stickers that is required to complete the album by running the code lots of times, and averaging the result.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
Add a for loop around the code above to run 100 simulations of collecting an entire album, storing the number of stickers required in each simulation in a vector. Apply the function built-in R function <code>mean</code> to the vector to estimate the average number of stickers that must be bought to complete the album.
</div>
</div>
<button id="displayTextunnamed-chunk-36" onclick="javascript:toggle(&#39;unnamed-chunk-36&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-36" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="programming-practical---p1.html#cb33-1" aria-hidden="true" tabindex="-1"></a>myEstimates <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb33-2"><a href="programming-practical---p1.html#cb33-2" aria-hidden="true" tabindex="-1"></a>numRuns <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb33-3"><a href="programming-practical---p1.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numRuns) {</span>
<span id="cb33-4"><a href="programming-practical---p1.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  totStickers <span class="ot">&lt;-</span> <span class="dv">427</span></span>
<span id="cb33-5"><a href="programming-practical---p1.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  gotSticker <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">FALSE</span>,totStickers)</span>
<span id="cb33-6"><a href="programming-practical---p1.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  numLeft <span class="ot">&lt;-</span> totStickers</span>
<span id="cb33-7"><a href="programming-practical---p1.html#cb33-7" aria-hidden="true" tabindex="-1"></a>  numStickersBought <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb33-8"><a href="programming-practical---p1.html#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(numLeft <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb33-9"><a href="programming-practical---p1.html#cb33-9" aria-hidden="true" tabindex="-1"></a>    numStickersBought <span class="ot">&lt;-</span> numStickersBought <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb33-10"><a href="programming-practical---p1.html#cb33-10" aria-hidden="true" tabindex="-1"></a>    thisSticker <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>totStickers,<span class="dv">1</span>)</span>
<span id="cb33-11"><a href="programming-practical---p1.html#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(gotSticker[thisSticker]<span class="sc">==</span><span class="cn">FALSE</span>) {     <span class="co"># this is the line which had an error (fixed here)</span></span>
<span id="cb33-12"><a href="programming-practical---p1.html#cb33-12" aria-hidden="true" tabindex="-1"></a>      gotSticker[thisSticker] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb33-13"><a href="programming-practical---p1.html#cb33-13" aria-hidden="true" tabindex="-1"></a>      numLeft <span class="ot">&lt;-</span> numLeft <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb33-14"><a href="programming-practical---p1.html#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   commented out the following print statement to save time</span></span>
<span id="cb33-15"><a href="programming-practical---p1.html#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   print(paste(&#39;got&#39;, thisSticker, &#39;still need&#39;,numLeft))</span></span>
<span id="cb33-16"><a href="programming-practical---p1.html#cb33-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-17"><a href="programming-practical---p1.html#cb33-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-18"><a href="programming-practical---p1.html#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Run&quot;</span>,i,<span class="st">&quot;bought&quot;</span>, numStickersBought))</span>
<span id="cb33-19"><a href="programming-practical---p1.html#cb33-19" aria-hidden="true" tabindex="-1"></a>  myEstimates[i] <span class="ot">&lt;-</span> numStickersBought</span>
<span id="cb33-20"><a href="programming-practical---p1.html#cb33-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Run 1 bought 2892&quot;
## [1] &quot;Run 2 bought 3987&quot;
## [1] &quot;Run 3 bought 2626&quot;
## [1] &quot;Run 4 bought 3780&quot;
## [1] &quot;Run 5 bought 2280&quot;
## [1] &quot;Run 6 bought 3211&quot;
## [1] &quot;Run 7 bought 3078&quot;
## [1] &quot;Run 8 bought 2661&quot;
## [1] &quot;Run 9 bought 3480&quot;
## [1] &quot;Run 10 bought 2651&quot;
## [1] &quot;Run 11 bought 2900&quot;
## [1] &quot;Run 12 bought 3301&quot;
## [1] &quot;Run 13 bought 2793&quot;
## [1] &quot;Run 14 bought 2242&quot;
## [1] &quot;Run 15 bought 2798&quot;
## [1] &quot;Run 16 bought 2489&quot;
## [1] &quot;Run 17 bought 3094&quot;
## [1] &quot;Run 18 bought 3684&quot;
## [1] &quot;Run 19 bought 2588&quot;
## [1] &quot;Run 20 bought 2947&quot;
## [1] &quot;Run 21 bought 2918&quot;
## [1] &quot;Run 22 bought 2581&quot;
## [1] &quot;Run 23 bought 4000&quot;
## [1] &quot;Run 24 bought 3198&quot;
## [1] &quot;Run 25 bought 3811&quot;
## [1] &quot;Run 26 bought 2935&quot;
## [1] &quot;Run 27 bought 2673&quot;
## [1] &quot;Run 28 bought 3214&quot;
## [1] &quot;Run 29 bought 2566&quot;
## [1] &quot;Run 30 bought 2471&quot;
## [1] &quot;Run 31 bought 2457&quot;
## [1] &quot;Run 32 bought 2582&quot;
## [1] &quot;Run 33 bought 2490&quot;
## [1] &quot;Run 34 bought 2443&quot;
## [1] &quot;Run 35 bought 2642&quot;
## [1] &quot;Run 36 bought 3243&quot;
## [1] &quot;Run 37 bought 3039&quot;
## [1] &quot;Run 38 bought 2886&quot;
## [1] &quot;Run 39 bought 3610&quot;
## [1] &quot;Run 40 bought 3230&quot;
## [1] &quot;Run 41 bought 2301&quot;
## [1] &quot;Run 42 bought 2173&quot;
## [1] &quot;Run 43 bought 2931&quot;
## [1] &quot;Run 44 bought 1967&quot;
## [1] &quot;Run 45 bought 2369&quot;
## [1] &quot;Run 46 bought 2550&quot;
## [1] &quot;Run 47 bought 2491&quot;
## [1] &quot;Run 48 bought 3804&quot;
## [1] &quot;Run 49 bought 2308&quot;
## [1] &quot;Run 50 bought 3164&quot;
## [1] &quot;Run 51 bought 3037&quot;
## [1] &quot;Run 52 bought 2091&quot;
## [1] &quot;Run 53 bought 2185&quot;
## [1] &quot;Run 54 bought 2114&quot;
## [1] &quot;Run 55 bought 2097&quot;
## [1] &quot;Run 56 bought 2524&quot;
## [1] &quot;Run 57 bought 2284&quot;
## [1] &quot;Run 58 bought 3062&quot;
## [1] &quot;Run 59 bought 2274&quot;
## [1] &quot;Run 60 bought 2605&quot;
## [1] &quot;Run 61 bought 4299&quot;
## [1] &quot;Run 62 bought 2429&quot;
## [1] &quot;Run 63 bought 3046&quot;
## [1] &quot;Run 64 bought 2396&quot;
## [1] &quot;Run 65 bought 2734&quot;
## [1] &quot;Run 66 bought 3590&quot;
## [1] &quot;Run 67 bought 2084&quot;
## [1] &quot;Run 68 bought 3595&quot;
## [1] &quot;Run 69 bought 2993&quot;
## [1] &quot;Run 70 bought 2261&quot;
## [1] &quot;Run 71 bought 3571&quot;
## [1] &quot;Run 72 bought 2664&quot;
## [1] &quot;Run 73 bought 2640&quot;
## [1] &quot;Run 74 bought 2755&quot;
## [1] &quot;Run 75 bought 2367&quot;
## [1] &quot;Run 76 bought 2228&quot;
## [1] &quot;Run 77 bought 2338&quot;
## [1] &quot;Run 78 bought 2522&quot;
## [1] &quot;Run 79 bought 2204&quot;
## [1] &quot;Run 80 bought 2745&quot;
## [1] &quot;Run 81 bought 2896&quot;
## [1] &quot;Run 82 bought 2397&quot;
## [1] &quot;Run 83 bought 2800&quot;
## [1] &quot;Run 84 bought 2173&quot;
## [1] &quot;Run 85 bought 3001&quot;
## [1] &quot;Run 86 bought 2616&quot;
## [1] &quot;Run 87 bought 2746&quot;
## [1] &quot;Run 88 bought 2822&quot;
## [1] &quot;Run 89 bought 3164&quot;
## [1] &quot;Run 90 bought 3090&quot;
## [1] &quot;Run 91 bought 2343&quot;
## [1] &quot;Run 92 bought 3609&quot;
## [1] &quot;Run 93 bought 4124&quot;
## [1] &quot;Run 94 bought 1883&quot;
## [1] &quot;Run 95 bought 2332&quot;
## [1] &quot;Run 96 bought 3085&quot;
## [1] &quot;Run 97 bought 3552&quot;
## [1] &quot;Run 98 bought 3173&quot;
## [1] &quot;Run 99 bought 2682&quot;
## [1] &quot;Run 100 bought 3427&quot;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="programming-practical---p1.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(myEstimates)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-265-1.png" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="programming-practical---p1.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(myEstimates)</span></code></pre></div>
<pre><code>## [1] 2821.78</code></pre>
</div>
</div>
</div>
<p>The expected value (i.e. mean) number of stickers that is required to complete an album of 427 stickers is in fact <span class="math inline">\(427 \times H_{427}\)</span>, where <span class="math inline">\(H_{427}\)</span> is the 427<span class="math inline">\(^{th}\)</span> Harmonic number (the mathematics of this is explained in the appendix).</p>
<p>It turns out that <span class="math inline">\(H_{427} \approx 6.635\)</span>, and so the estimated mean is about 2,800 or so. This is a lot of stickers! The requisite number would be reduced in practice, because you are able swap duplicate stickers with your friends, as well as send off to Panini on a special form for a maximum of 50 stickers towards the end, but nevertheless, this simulation has explained my disappointment as a 9-year-old child!</p>
</div>
<div id="extended-example-two-the-logistic-map" class="section level3 hasAnchor" number="2.9.2">
<h3><span class="header-section-number">2.9.2</span> Extended example two: the logistic map<a href="programming-practical---p1.html#extended-example-two-the-logistic-map" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The logistic map is a simple population model in discrete-time, and relates the size of a population in generation n+1 to its size in generation n. It is one of the simplest models that shows “chaotic” behaviour.</p>
<p>One way of writing the logistic map is via the following recurrence <span class="math display">\[x_{n+1} = rx_{n}(1-x_{n}) \]</span> where <span class="math inline">\(x_{n}\)</span> is the population size in year <span class="math inline">\(n\)</span>, measured as a fraction of the carrying capacity, and <span class="math inline">\(r\)</span> is the intrinsic rate of increase (a growth rate).</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<p>What do you think is the purpose of the following function?</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="programming-practical---p1.html#cb38-1" aria-hidden="true" tabindex="-1"></a>logisticValues <span class="ot">&lt;-</span> <span class="cf">function</span>(r,N,x0) { </span>
<span id="cb38-2"><a href="programming-practical---p1.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  retVal <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb38-3"><a href="programming-practical---p1.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  thisX <span class="ot">&lt;-</span> x0</span>
<span id="cb38-4"><a href="programming-practical---p1.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { </span>
<span id="cb38-5"><a href="programming-practical---p1.html#cb38-5" aria-hidden="true" tabindex="-1"></a>    thisX <span class="ot">&lt;-</span> r <span class="sc">*</span> thisX <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> thisX)</span>
<span id="cb38-6"><a href="programming-practical---p1.html#cb38-6" aria-hidden="true" tabindex="-1"></a>    retVal[i] <span class="ot">&lt;-</span> thisX </span>
<span id="cb38-7"><a href="programming-practical---p1.html#cb38-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-8"><a href="programming-practical---p1.html#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(retVal) </span>
<span id="cb38-9"><a href="programming-practical---p1.html#cb38-9" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
</div>
</div>
<button id="displayTextunnamed-chunk-38" onclick="javascript:toggle(&#39;unnamed-chunk-38&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-38" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<p>The given function returns <span class="math inline">\(N\)</span> iterates of the logistic map starting at <span class="math inline">\(x_0\)</span> (note, does not store initial value)</p>
</div>
</div>
</div>
<p>Include the function <code>logisticValues</code> in your script.</p>
<p>Also include the following code that uses the function to plot a graph.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="programming-practical---p1.html#cb39-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">1.5</span>        <span class="co"># growth rate</span></span>
<span id="cb39-2"><a href="programming-practical---p1.html#cb39-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span>        <span class="co"># max generation</span></span>
<span id="cb39-3"><a href="programming-practical---p1.html#cb39-3" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fl">0.01</span>      <span class="co"># initial value</span></span>
<span id="cb39-4"><a href="programming-practical---p1.html#cb39-4" aria-hidden="true" tabindex="-1"></a>xn <span class="ot">&lt;-</span> <span class="fu">logisticValues</span>(r,N,x0)  <span class="co"># next N starting at x0 </span></span>
<span id="cb39-5"><a href="programming-practical---p1.html#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span>N,<span class="fu">c</span>(x0,xn),<span class="at">type=</span><span class="st">&#39;o&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;n&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;x_n&#39;</span>)  <span class="co"># plot</span></span></code></pre></div>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
Try running the code for different values of r. What does the graph show you?
</div>
</div>
<button id="displayTextunnamed-chunk-41" onclick="javascript:toggle(&#39;unnamed-chunk-41&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-41" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<p>This code shows the behaviour of the logistic map with <span class="math inline">\(r = 1.5\)</span> for 100 generations. Note the slightly clunky way of making sure the initial point is returned.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-267-1.png" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<p>Good values of <span class="math inline">\(r\)</span> to try would be <span class="math inline">\(r = 0.5\)</span>, <span class="math inline">\(r = 1.5\)</span>, <span class="math inline">\(r = 2.5\)</span>, <span class="math inline">\(r = 3.1\)</span>, <span class="math inline">\(r = 3.5\)</span>, <span class="math inline">\(r = 3.7\)</span>. You should also test the behaviour for different initial conditions: suitable values would be <span class="math inline">\(x_{0} = 0.01\)</span> and <span class="math inline">\(x_{0} = 0.1\)</span>.</p>
<div class="panel panel-default">
<div class="panel-heading panel-heading2">
Note:
</div>
<div class="panel-body">
As you change the value of <span class="math inline">\(r\)</span> in the above code the system goes from having a single equilibrium in the long term, to oscillating between a pair of values, to oscillating between four values. By <span class="math inline">\(r = 3.7\)</span>, the trajectory depends very sensitively to the initial value <span class="math inline">\(x0\)</span> (as is demonstrated by the below code). This is called deterministic chaos.
</div>
</div>
<p>You should note that in the case <span class="math inline">\(r = 3.7\)</span>, the pattern of successive population sizes appears to be fairly random. It also depends on the initial value of <span class="math inline">\(x0\)</span>.</p>
<p>The following code confirms this (note the first five lines are almost exactly as they were before): include this code in your script to check this.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="programming-practical---p1.html#cb40-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">3.7</span>            <span class="co"># growth rate</span></span>
<span id="cb40-2"><a href="programming-practical---p1.html#cb40-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span>            <span class="co"># max generation</span></span>
<span id="cb40-3"><a href="programming-practical---p1.html#cb40-3" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fl">0.01</span>          <span class="co"># initial value</span></span>
<span id="cb40-4"><a href="programming-practical---p1.html#cb40-4" aria-hidden="true" tabindex="-1"></a>xn <span class="ot">&lt;-</span> <span class="fu">logisticValues</span>(r,N,x0)    <span class="co"># next N starting at x0</span></span>
<span id="cb40-5"><a href="programming-practical---p1.html#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span>N,<span class="fu">c</span>(x0,xn),<span class="at">type=</span><span class="st">&#39;o&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;n&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;x_n&#39;</span>) <span class="co"># plot </span></span>
<span id="cb40-6"><a href="programming-practical---p1.html#cb40-6" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fl">0.01001</span>       <span class="co"># different initial value</span></span>
<span id="cb40-7"><a href="programming-practical---p1.html#cb40-7" aria-hidden="true" tabindex="-1"></a>xn <span class="ot">&lt;-</span> <span class="fu">logisticValues</span>(r,N,x0)    <span class="co"># next N starting there</span></span>
<span id="cb40-8"><a href="programming-practical---p1.html#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">0</span><span class="sc">:</span>N,<span class="fu">c</span>(x0,xn),<span class="at">type=</span><span class="st">&#39;o&#39;</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>) <span class="co"># overlay on plot</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" style="display: block; margin: auto;" /></p>
<p>Notice that, despite starting very close together, the trajectories diverge over time. “Sensitive dependence on initial conditions” is characteristic of deterministic chaos.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<p>What do you think the following code does?</p>
<p>Test your understanding by typing the function in and running it by issuing an appropriate call to the function at the command prompt.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="programming-practical---p1.html#cb41-1" aria-hidden="true" tabindex="-1"></a>logisticValuesAfterBurnIn <span class="ot">&lt;-</span> <span class="cf">function</span>(r,N,M,x0) { </span>
<span id="cb41-2"><a href="programming-practical---p1.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  retVal <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb41-3"><a href="programming-practical---p1.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  thisX <span class="ot">&lt;-</span> x0</span>
<span id="cb41-4"><a href="programming-practical---p1.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { </span>
<span id="cb41-5"><a href="programming-practical---p1.html#cb41-5" aria-hidden="true" tabindex="-1"></a>    thisX <span class="ot">&lt;-</span> r <span class="sc">*</span> thisX <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> thisX)</span>
<span id="cb41-6"><a href="programming-practical---p1.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-7"><a href="programming-practical---p1.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) { </span>
<span id="cb41-8"><a href="programming-practical---p1.html#cb41-8" aria-hidden="true" tabindex="-1"></a>    thisX <span class="ot">&lt;-</span> r <span class="sc">*</span> thisX <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> thisX)</span>
<span id="cb41-9"><a href="programming-practical---p1.html#cb41-9" aria-hidden="true" tabindex="-1"></a>    retVal[i] <span class="ot">&lt;-</span> thisX </span>
<span id="cb41-10"><a href="programming-practical---p1.html#cb41-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-11"><a href="programming-practical---p1.html#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(retVal) </span>
<span id="cb41-12"><a href="programming-practical---p1.html#cb41-12" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
</div>
</div>
<button id="displayTextunnamed-chunk-45" onclick="javascript:toggle(&#39;unnamed-chunk-45&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-45" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
The given code performs <span class="math inline">\(N\)</span> iterations of the logistic map starting from <span class="math inline">\(x_0\)</span> but does not store them. It then calculates, stores and returns the following <span class="math inline">\(M\)</span> iterations of the logistic map.
</div>
</div>
</div>
<p>Enter the following code and run it.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="programming-practical---p1.html#cb42-1" aria-hidden="true" tabindex="-1"></a>rVals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">2.5</span>,<span class="dv">4</span>,<span class="at">by=</span><span class="fl">0.005</span>)</span>
<span id="cb42-2"><a href="programming-practical---p1.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="fl">2.5</span>,<span class="dv">4</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">type=</span><span class="st">&#39;n&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;r&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;orbit&#39;</span>)</span>
<span id="cb42-3"><a href="programming-practical---p1.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(r <span class="cf">in</span> rVals) { </span>
<span id="cb42-4"><a href="programming-practical---p1.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">1000</span>     </span>
<span id="cb42-5"><a href="programming-practical---p1.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="dv">100</span> </span>
<span id="cb42-6"><a href="programming-practical---p1.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  xn <span class="ot">&lt;-</span> <span class="fu">logisticValuesAfterBurnIn</span>(r,N,M,<span class="fl">0.01</span>)   </span>
<span id="cb42-7"><a href="programming-practical---p1.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(<span class="fu">rep</span>(r,M),xn,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">cex=</span><span class="fl">0.01</span>)</span>
<span id="cb42-8"><a href="programming-practical---p1.html#cb42-8" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-1.png" style="display: block; margin: auto;" /></p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
<p>What happens?</p>
Do you understand what the plot – a so-called “bifurcation diagram” -– is showing?
</div>
</div>
<button id="displayTextunnamed-chunk-48" onclick="javascript:toggle(&#39;unnamed-chunk-48&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-48" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<p>The key idea is that - for each value of <span class="math inline">\(r\)</span> - it calculates <span class="math inline">\(N=1000\)</span> iterations of the map, but totally ignores them. It then plots the values of the next 100 iterations (as the y-value on a graph which has the value of <span class="math inline">\(r\)</span> as the x-ordinate). The idea behind all this is to let the system equilibriate - if it is ever going to do so. So from the bifurcation diagram you can see from this picture that there is/are:</p>
<ul>
<li>a single equilibrium for <span class="math inline">\(2.5 &lt; r &lt; 3.0\)</span></li>
<li>two equilibria for <span class="math inline">\(3.0 &lt; r &lt; 3.45\)</span> (-ish)</li>
<li>four equilibria for <span class="math inline">\(3.45\)</span>(-ish) <span class="math inline">\(&lt; r &lt; 3.54\)</span> (-ish)</li>
<li>by <span class="math inline">\(r \sim 3.57\)</span>, we have chaos (as seen in plots for different starting conditions above) which here corresponds to a more or less random - although lying within certain bounds - set of 100 points plotted for each <span class="math inline">\(r\)</span></li>
</ul>
This is explained well on the relevant <a href="https://en.wikipedia.org/wiki/Logistic_map#Behavior_dependent_on_r">wikipedia page</a>
</div>
</div>
</div>
<p>A very readable introduction to deterministic chaos in biology is given by May (1976) (“Simple mathematical models with very complicated dynamics”. Nature 261: 459-467). That article is widely available online and comes highly recommended.</p>
</div>
</div>
<div id="appendix-relating-sticker-collecting-to-the-harmonic-numbers" class="section level2 hasAnchor" number="2.10">
<h2><span class="header-section-number">2.10</span> Appendix: relating sticker collecting to the harmonic numbers<a href="programming-practical---p1.html#appendix-relating-sticker-collecting-to-the-harmonic-numbers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the lecture I claimed that the example of collecting things is somehow related to the harmonic series. To see this does not require sophisticated mathematics.</p>
<p>If there are a total of <span class="math inline">\(N\)</span> stickers, of which you have already collected <span class="math inline">\(M\)</span>, the probability of a new sticker being one you “need” is <span class="math inline">\(p_{M} = (N-M)/N\)</span>. Assuming that successive purchases are independent, the number of stickers that must be bought to get a sticker you need when you already have <span class="math inline">\(M\)</span> stickers in your album would follow a geometric probability distribution<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. The expected number of stickers needed to get the <span class="math inline">\(M^{th}\)</span> sticker is therefore <span class="math inline">\(\frac{1}{p_{M}}\)</span>.</p>
<p>The number of stickers that you must buy to complete the entire album is then just the expected number of stickers to get the first sticker in your album (i.e. when you have already got 0), plus the expected number required for your second sticker (i.e. when you have already got 1), …, all the way up to the expected number to get the final sticker (i.e. when you have already got <span class="math inline">\(N – 1\)</span>).</p>
<p>Therefore <span class="math display">\[\text{Average number of stickers required} = \frac{1}{p_{0}} + \frac{1}{p_{1}} + \text{... } +\frac{1}{p_{N-1}}.\]</span></p>
<p>However (by the definition of <span class="math inline">\(p_{M}\)</span>) this reduces to <span class="math display">\[\begin{aligned} \text{Average number of stickers required} &amp;= \frac{N}{N} + \frac{N}{N-1} + \text{... } + \frac{N}{1} \\ &amp;=N\left(\frac{N}{N} + \frac{N}{N-1} + \text{... } + \frac{1}{1}\right) \\ &amp;=N\left(1 + \text{... } + \frac{1}{N-1} + \frac{1}{N}\right) \\ &amp;=N \times H_{N}\end{aligned} \]</span></p>
<p>where we reversed the order of the sum in going from line 2 to line 3, and have used the definition of the <span class="math inline">\(N^{th}\)</span> harmonic number (see lecture slides) on line 4.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>You will be reminded of basic facts about probability distributions in a forthcoming lecture. Note the expected number is quite intuitive: as a simple example, consider rolling a dice until you get a six. The probability of getting a six is <span class="math inline">\(\frac{1}{6}\)</span>: hopefully it seems reasonable that you should have to roll the dice an average of 6 times to get one. That’s all that is happening here, just written in symbols.<a href="programming-practical---p1.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="programming-practical---p2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
