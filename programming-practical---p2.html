<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Programming Practical - P2 | R-Practical</title>
  <meta name="description" content="3 Programming Practical - P2 | R-Practical" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Programming Practical - P2 | R-Practical" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="3 Programming Practical - P2 | R-Practical" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Programming Practical - P2 | R-Practical" />
  
  <meta name="twitter:description" content="3 Programming Practical - P2 | R-Practical" />
  

<meta name="author" content="Pedro Cardoso" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="programming-practical---p1.html"/>
<link rel="next" href="dynamic-models-practical.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script language="javascript"> 
    function toggle(id) {
        var ele = document.getElementById("toggleText" + id);
        var text = document.getElementById("displayText" + id);
        var buttonText = text.innerHTML.replace("Show: ", "");
        buttonText = buttonText.replace("Hide: ", "");
        if(ele.style.display == "block") {
            ele.style.display = "none";
            text.innerHTML = "Show: " + buttonText;
        } else {
            ele.style.display = "block";
            text.innerHTML = "Hide: " + buttonText;
        }
    } 
</script>

<script language="javascript">
    function openCode(evt, codeName, id) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent" + id);
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks" + id);
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(codeName).style.display = "block";
        evt.currentTarget.className += " active";
    }
</script>

<script language="javascript">
    function hide(id){
        document.getElementById(id).style.display = "none";
    }
</script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Opening</a></li>
<li class="chapter" data-level="2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html"><i class="fa fa-check"></i><b>2</b> Programming Practical - P1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#getting-started"><i class="fa fa-check"></i><b>2.1</b> Getting started</a></li>
<li class="chapter" data-level="2.2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#predicting-the-behaviour-of-for-loops"><i class="fa fa-check"></i><b>2.2</b> Predicting the behaviour of for loops</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#example-one"><i class="fa fa-check"></i><b>2.2.1</b> Example one</a></li>
<li class="chapter" data-level="2.2.2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#example-two"><i class="fa fa-check"></i><b>2.2.2</b> Example two</a></li>
<li class="chapter" data-level="2.2.3" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#example-three"><i class="fa fa-check"></i><b>2.2.3</b> Example three</a></li>
<li class="chapter" data-level="2.2.4" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#example-four"><i class="fa fa-check"></i><b>2.2.4</b> Example four</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#writing-a-for-loop"><i class="fa fa-check"></i><b>2.3</b> Writing a for loop</a></li>
<li class="chapter" data-level="2.4" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#writing-a-while-loop"><i class="fa fa-check"></i><b>2.4</b> Writing a while loop</a></li>
<li class="chapter" data-level="2.5" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#using-loops-to-do-more-complex-calculations"><i class="fa fa-check"></i><b>2.5</b> Using loops to do more complex calculations</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#a-loop-for-which-the-number-of-iterations-is-known-in-advance"><i class="fa fa-check"></i><b>2.5.1</b> A loop for which the number of iterations is known in advance</a></li>
<li class="chapter" data-level="2.5.2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#a-loop-for-which-the-number-of-iterations-is-not-know-in-advance"><i class="fa fa-check"></i><b>2.5.2</b> A loop for which the number of iterations is not know in advance</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#writing-simple-functions"><i class="fa fa-check"></i><b>2.6</b> Writing simple functions</a></li>
<li class="chapter" data-level="2.7" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#predicting-the-behaviour-of-a-function"><i class="fa fa-check"></i><b>2.7</b> Predicting the behaviour of a function</a></li>
<li class="chapter" data-level="2.8" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#return-values-from-functions"><i class="fa fa-check"></i><b>2.8</b> Return values from functions</a></li>
<li class="chapter" data-level="2.9" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#additional-tasks-for-those-with-programming-experience"><i class="fa fa-check"></i><b>2.9</b> Additional tasks for those with programming experience</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#extended-example-one-monte-carlo-simulation"><i class="fa fa-check"></i><b>2.9.1</b> Extended example one: Monte Carlo simulation</a></li>
<li class="chapter" data-level="2.9.2" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#extended-example-two-the-logistic-map"><i class="fa fa-check"></i><b>2.9.2</b> Extended example two: the logistic map</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="programming-practical---p1.html"><a href="programming-practical---p1.html#appendix-relating-sticker-collecting-to-the-harmonic-numbers"><i class="fa fa-check"></i><b>2.10</b> Appendix: relating sticker collecting to the harmonic numbers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html"><i class="fa fa-check"></i><b>3</b> Programming Practical - P2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#random-variables"><i class="fa fa-check"></i><b>3.1</b> Random variables</a></li>
<li class="chapter" data-level="3.2" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#probability-distributions"><i class="fa fa-check"></i><b>3.2</b> Probability distributions</a></li>
<li class="chapter" data-level="3.3" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#using-probability-distributions-in-r---types"><i class="fa fa-check"></i><b>3.3</b> Using probability distributions in R - types</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#ddist"><i class="fa fa-check"></i><b>3.3.1</b> <code>ddist()</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#pdist"><i class="fa fa-check"></i><b>3.3.2</b> <code>pdist()</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#rdist"><i class="fa fa-check"></i><b>3.3.3</b> <code>rdist()</code></a></li>
<li class="chapter" data-level="3.3.4" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#rnorm---normal-distribution"><i class="fa fa-check"></i><b>3.3.4</b> <code>rnorm()</code> - Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#example-one---using-probabilities-for-simulation"><i class="fa fa-check"></i><b>3.4</b> Example one - using probabilities for simulation</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#binomial-distribution"><i class="fa fa-check"></i><b>3.4.1</b> Binomial Distribution</a></li>
<li class="chapter" data-level="3.4.2" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#normal-distribution"><i class="fa fa-check"></i><b>3.4.2</b> Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#example-two---multiple-choices"><i class="fa fa-check"></i><b>3.5</b> Example two - multiple choices</a></li>
<li class="chapter" data-level="3.6" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#exercise-one---using-r-to-model-a-die"><i class="fa fa-check"></i><b>3.6</b> Exercise one - using R to model a die</a></li>
<li class="chapter" data-level="3.7" data-path="programming-practical---p2.html"><a href="programming-practical---p2.html#example-three---using-r-to-model-a-death-process-stochastically"><i class="fa fa-check"></i><b>3.7</b> Example three - using R to model a death process stochastically</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html"><i class="fa fa-check"></i><b>4</b> Dynamic models Practical</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html#introduction-to-desolve"><i class="fa fa-check"></i><b>4.1</b> Introduction to deSolve</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html#a-bit-of-theory"><i class="fa fa-check"></i><b>4.1.1</b> A bit of theory</a></li>
<li class="chapter" data-level="4.1.2" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html#the-return-of-the-logistic-model"><i class="fa fa-check"></i><b>4.1.2</b> The return of the logistic model</a></li>
<li class="chapter" data-level="4.1.3" data-path="dynamic-models-practical.html"><a href="dynamic-models-practical.html#the-revenge-of-the-amoeba"><i class="fa fa-check"></i><b>4.1.3</b> The revenge of the amoeba</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html"><i class="fa fa-check"></i><b>5</b> Epidemic models - P1</a>
<ul>
<li class="chapter" data-level="5.1" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#the-basic-sir-model"><i class="fa fa-check"></i><b>5.1</b> The basic SIR model</a></li>
<li class="chapter" data-level="5.2" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#coding-the-model"><i class="fa fa-check"></i><b>5.2</b> Coding the model</a></li>
<li class="chapter" data-level="5.3" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#some-properties-of-the-model"><i class="fa fa-check"></i><b>5.3</b> Some properties of the model</a></li>
<li class="chapter" data-level="5.4" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#calculating-the-infectious-period"><i class="fa fa-check"></i><b>5.4</b> Calculating the infectious period</a></li>
<li class="chapter" data-level="5.5" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#optional-section---extending-sir-to-other-compartments"><i class="fa fa-check"></i><b>5.5</b> Optional section - extending SIR to other compartments</a></li>
<li class="chapter" data-level="5.6" data-path="epidemic-models---p1.html"><a href="epidemic-models---p1.html#appendeix---epidemic-peak-and-final-epidemic-size"><i class="fa fa-check"></i><b>5.6</b> Appendeix - Epidemic peak and final epidemic size</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="epidemic-models---p2.html"><a href="epidemic-models---p2.html"><i class="fa fa-check"></i><b>6</b> Epidemic models - P2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="epidemic-models---p2.html"><a href="epidemic-models---p2.html#calculating-r_0"><i class="fa fa-check"></i><b>6.1</b> Calculating <span class="math inline">\(R_{0}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html"><i class="fa fa-check"></i><b>7</b> Epidemic models - P3</a>
<ul>
<li class="chapter" data-level="7.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#coding-a-simple-si-model"><i class="fa fa-check"></i><b>7.1</b> Coding a simple SI model</a></li>
<li class="chapter" data-level="7.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#dissecting-the-stochastic-si-code"><i class="fa fa-check"></i><b>7.2</b> Dissecting the stochastic SI code</a></li>
<li class="chapter" data-level="7.3" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#performing-multiple-simulations"><i class="fa fa-check"></i><b>7.3</b> Performing Multiple Simulations</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#adding-the-deterministic-solution-curve"><i class="fa fa-check"></i><b>7.3.1</b> Adding the deterministic solution curve</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exploring-the-effects-of-stochasticity"><i class="fa fa-check"></i><b>7.4</b> Exploring the effects of Stochasticity</a></li>
<li class="chapter" data-level="7.5" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#the-delay-time"><i class="fa fa-check"></i><b>7.5</b> The delay time</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#the-deterministic-half-time"><i class="fa fa-check"></i><b>7.5.1</b> The deterministic half-time</a></li>
<li class="chapter" data-level="7.5.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#the-stochastic-half-time"><i class="fa fa-check"></i><b>7.5.2</b> The stochastic half-time</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#coding-a-simple-sir-model"><i class="fa fa-check"></i><b>7.6</b> Coding a simple SIR model</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-one"><i class="fa fa-check"></i><b>7.6.1</b> Exercise one</a></li>
<li class="chapter" data-level="7.6.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-two"><i class="fa fa-check"></i><b>7.6.2</b> Exercise two</a></li>
<li class="chapter" data-level="7.6.3" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-three"><i class="fa fa-check"></i><b>7.6.3</b> Exercise three</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#sis-extension-adding-recovery-from-infection"><i class="fa fa-check"></i><b>7.7</b> SIS Extension: Adding Recovery from Infection</a></li>
<li class="chapter" data-level="7.8" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#sis-extension-adding-host-demography"><i class="fa fa-check"></i><b>7.8</b> SIS Extension: Adding host demography</a></li>
<li class="chapter" data-level="7.9" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#sir-extension-the-final-epidemic-size"><i class="fa fa-check"></i><b>7.9</b> SIR Extension: The final epidemic size</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-one-1"><i class="fa fa-check"></i><b>7.9.1</b> Exercise one</a></li>
<li class="chapter" data-level="7.9.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-two-1"><i class="fa fa-check"></i><b>7.9.2</b> Exercise two</a></li>
<li class="chapter" data-level="7.9.3" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-three-1"><i class="fa fa-check"></i><b>7.9.3</b> Exercise three</a></li>
<li class="chapter" data-level="7.9.4" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-four"><i class="fa fa-check"></i><b>7.9.4</b> Exercise four</a></li>
<li class="chapter" data-level="7.9.5" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-five"><i class="fa fa-check"></i><b>7.9.5</b> Exercise five</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#sir-extension-stochastic-extinction"><i class="fa fa-check"></i><b>7.10</b> SIR Extension: Stochastic extinction</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#question"><i class="fa fa-check"></i><b>7.10.1</b> Question</a></li>
<li class="chapter" data-level="7.10.2" data-path="epidemic-models---p3.html"><a href="epidemic-models---p3.html#exercise-one-2"><i class="fa fa-check"></i><b>7.10.2</b> Exercise one</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html"><i class="fa fa-check"></i><b>8</b> Estimating <span class="math inline">\(R_{0}\)</span> - P1</a>
<ul>
<li class="chapter" data-level="8.1" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#introduction-models-and-data-sets"><i class="fa fa-check"></i><b>8.1</b> Introduction: Models and Data sets</a></li>
<li class="chapter" data-level="8.2" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#final-size-method"><i class="fa fa-check"></i><b>8.2</b> Final Size Method</a></li>
<li class="chapter" data-level="8.3" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#regression-method"><i class="fa fa-check"></i><b>8.3</b> Regression Method</a></li>
<li class="chapter" data-level="8.4" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#recon-earlyr-method"><i class="fa fa-check"></i><b>8.4</b> RECON earlyR method</a></li>
<li class="chapter" data-level="8.5" data-path="estimating-r_0---p1.html"><a href="estimating-r_0---p1.html#appendix"><i class="fa fa-check"></i><b>8.5</b> Appendix</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html"><i class="fa fa-check"></i><b>9</b> Seasonality and Measles Epidemics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html#measles-data-and-challenge"><i class="fa fa-check"></i><b>9.1</b> Measles data and challenge</a></li>
<li class="chapter" data-level="9.2" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html#standard-seir-exponential-with-sinusoidal-forcing"><i class="fa fa-check"></i><b>9.2</b> Standard SEIR (exponential) with sinusoidal forcing</a></li>
<li class="chapter" data-level="9.3" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html#standard-seir-exponential-with-term-time-forcing"><i class="fa fa-check"></i><b>9.3</b> Standard SEIR (exponential) with term-time forcing</a></li>
<li class="chapter" data-level="9.4" data-path="seasonality-and-measles-epidemics.html"><a href="seasonality-and-measles-epidemics.html#gamma-seir-with-term-time-forcing"><i class="fa fa-check"></i><b>9.4</b> Gamma SEIR with term-time forcing</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="outbreak-of-influenza-in-a-boarding-school.html"><a href="outbreak-of-influenza-in-a-boarding-school.html"><i class="fa fa-check"></i><b>10</b> Outbreak of influenza in a boarding school</a>
<ul>
<li class="chapter" data-level="10.1" data-path="outbreak-of-influenza-in-a-boarding-school.html"><a href="outbreak-of-influenza-in-a-boarding-school.html#data-summary-and-challenge"><i class="fa fa-check"></i><b>10.1</b> Data Summary and challenge</a></li>
<li class="chapter" data-level="10.2" data-path="outbreak-of-influenza-in-a-boarding-school.html"><a href="outbreak-of-influenza-in-a-boarding-school.html#deterministic-model"><i class="fa fa-check"></i><b>10.2</b> Deterministic model</a></li>
<li class="chapter" data-level="10.3" data-path="outbreak-of-influenza-in-a-boarding-school.html"><a href="outbreak-of-influenza-in-a-boarding-school.html#stochastic-model"><i class="fa fa-check"></i><b>10.3</b> Stochastic model</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-Practical</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="programming-practical---p2" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Programming Practical - P2<a href="programming-practical---p2.html#programming-practical---p2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="random-variables" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Random variables<a href="programming-practical---p2.html#random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A random variable can be thought of as the outcome of an experiment or a measurement i.e. something that can change each time you look at it.</p>
<p>Examples:</p>
<ul>
<li>The number of heads you obtain when tossing a coin 10 times</li>
<li>The number of emails you received in one hour</li>
<li>The lifetime of a light-bulb</li>
<li>The length of time an individual is infected for before recovering</li>
</ul>
</div>
<div id="probability-distributions" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Probability distributions<a href="programming-practical---p2.html#probability-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A probability distribution will tell us the probability of a random variable taking a specific value.</p>
<p>A Binomial Distribution will be able to give us the probability of obtaining <span class="math inline">\(x\)</span> heads if we toss a coin 10 times (where <span class="math inline">\(x\)</span> is any number).</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="programming-practical---p2.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb43-2"><a href="programming-practical---p2.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb43-3"><a href="programming-practical---p2.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>),</span>
<span id="cb43-4"><a href="programming-practical---p2.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;h&quot;</span>,</span>
<span id="cb43-5"><a href="programming-practical---p2.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Binomial Probability </span><span class="sc">\n</span><span class="st">Mass Function&quot;</span>,</span>
<span id="cb43-6"><a href="programming-practical---p2.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Number of Heads&quot;</span>,</span>
<span id="cb43-7"><a href="programming-practical---p2.html#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Probability&quot;</span></span>
<span id="cb43-8"><a href="programming-practical---p2.html#cb43-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-49-1.png" style="display: block; margin: auto;" /></p>
<p>This is an example of a discrete random variables, and so the distribution is called <strong>probability mass function</strong>.</p>
<p>For continuous random variables we can only calculate the probability of being in an interval.</p>
<p>A Normal Distribution will be able to gives us the probability of measurement errors, <span class="math inline">\(x\)</span>, being a certain size.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="programming-practical---p2.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb44-2"><a href="programming-practical---p2.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">100</span>),</span>
<span id="cb44-3"><a href="programming-practical---p2.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">100</span>), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb44-4"><a href="programming-practical---p2.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb44-5"><a href="programming-practical---p2.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Normal Probability </span><span class="sc">\n</span><span class="st">Density Function&quot;</span>,</span>
<span id="cb44-6"><a href="programming-practical---p2.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb44-7"><a href="programming-practical---p2.html#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Probability Density&quot;</span></span>
<span id="cb44-8"><a href="programming-practical---p2.html#cb44-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-50-1.png" style="display: block; margin: auto;" /></p>
<p>This is an example of a continuous random variable, and so the distribution is called a <strong>probability density function</strong>.</p>
</div>
<div id="using-probability-distributions-in-r---types" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Using probability distributions in R - types<a href="programming-practical---p2.html#using-probability-distributions-in-r---types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R has a large number of inbuilt probability distributions.</p>
<p>Discrete distributions:</p>
<ul>
<li>Binomial</li>
<li>Geometric</li>
<li>Poisson</li>
<li>Negative Binomial</li>
<li>Hypergeometric</li>
<li>Multinomial</li>
</ul>
<p>Continuous distributions:</p>
<ul>
<li>Normal</li>
<li>Uniform</li>
<li>T (T-test)</li>
<li>F (F-test)</li>
<li>Exponential</li>
<li>Cauchy</li>
<li>Beta</li>
<li>Gamma</li>
<li>Weibull</li>
<li>Chi-squared</li>
<li>Logistic</li>
</ul>
<p>R deals with them all in essentially the same way. Each inbuilt distribution in R is referred to by its abbreviation.</p>
<ul>
<li>Binomial: <code>binom</code></li>
<li>Poisson: <code>pois</code></li>
<li>Geometric: <code>geom</code></li>
<li>Normal: <code>norm</code></li>
<li>Uniform: <code>unif</code></li>
<li>Exponential: <code>exp</code></li>
<li>…</li>
</ul>
<p>Each inbuilt distribution in R has the same four generic functions associated with it.</p>
<p>For a distribution with abbreviation <code>dist</code>:</p>
<ul>
<li><code>ddist()</code>: density/mass function</li>
<li><code>pdist()</code>: cumulative density/mass function</li>
<li><code>rdist()</code>: random number generator function</li>
<li><code>qdist()</code>: quantile function</li>
</ul>
<div id="ddist" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> <code>ddist()</code><a href="programming-practical---p2.html#ddist" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For a distribution type <code>dist</code>, the function <code>ddist(x,...)</code> returns:</p>
<ul>
<li>The probability <span class="math inline">\(P(X=x)\)</span> (for discrete variables) or</li>
<li>The probability density at <span class="math inline">\(x\)</span> (for continuous variables)</li>
</ul>
<p>This can be used to calculate actual probabilities for discrete distributions.</p>
<div id="dbinom---discrete-distribution" class="section level4 hasAnchor" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span> <code>dbinom()</code> - discrete distribution<a href="programming-practical---p2.html#dbinom---discrete-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider a Binomial Distribution with 10 trials, each with a probability of success of 0.5. The R function <code>dbinom()</code> describes the distribution of the probability of success.</p>
<p>It takes the following arguments:</p>
<ul>
<li><span class="math inline">\(x\)</span>: the number of successful trials</li>
<li>size: the total number of trials</li>
<li>prob: the probability of success</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="programming-practical---p2.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.2050781</code></pre>
<p>Or to plot the distribution itself.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="programming-practical---p2.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 0.0009765625 0.0097656250 0.0439453125 0.1171875000 0.2050781250
##  [6] 0.2460937500 0.2050781250 0.1171875000 0.0439453125 0.0097656250
## [11] 0.0009765625</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="programming-practical---p2.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">0.5</span>), <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Probability Density&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" style="display: block; margin: auto;" /></p>
</div>
<div id="dnorm---continuous-distribution" class="section level4 hasAnchor" number="3.3.1.2">
<h4><span class="header-section-number">3.3.1.2</span> <code>dnorm()</code> - continuous distribution<a href="programming-practical---p2.html#dnorm---continuous-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Consider a Normal Distribution with mean 0 and standard deviation 1.</p>
<p>The R function <code>dnorm()</code> gives the probability density at a given value of <span class="math inline">\(x\)</span>.</p>
<p>It takes the following arguments:</p>
<ul>
<li><span class="math inline">\(x\)</span></li>
<li>mean</li>
<li>sd: standard deviation</li>
</ul>
<p>The function <code>dnorm(x, mean, sd)</code> isn’t useful in itself but is useful for plotting.</p>
<p>With a continuous distribution we have to choose the <span class="math inline">\(x\)</span> coordinates close enough together to approximate a smooth curve.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="programming-practical---p2.html#cb50-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb50-2"><a href="programming-practical---p2.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Probability Density&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="pdist" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> <code>pdist()</code><a href="programming-practical---p2.html#pdist" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For a distribution dist <code>pdist(x, ...)</code> returns the probability <span class="math inline">\(P(X\le x)\)</span> (which in a continuous function is an actual probability).</p>
<div id="pnorm---probability-calculations" class="section level4 hasAnchor" number="3.3.2.1">
<h4><span class="header-section-number">3.3.2.1</span> <code>pnorm()</code> - probability calculations<a href="programming-practical---p2.html#pnorm---probability-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If we want to find the probability of having a value below <span class="math inline">\(-1\)</span> from a Normal Distribution we use <code>pnorm()</code>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="programming-practical---p2.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1586553</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" style="display: block; margin: auto;" /></p>
<p>If we want to find the probability of having a value between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1.5\)</span> from a Normal Distribution we use <code>pnorm()</code>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="programming-practical---p2.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.5</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.7745375</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="rdist" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> <code>rdist()</code><a href="programming-practical---p2.html#rdist" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For a distribution dist <code>rdist()</code> returns <span class="math inline">\(n\)</span> random numbers drawn from that distribution.</p>
<p>This function is of great use when trying to run stochastic models. The ability to draw random numbers from many different types of distribution is incredibly useful.</p>
</div>
<div id="rnorm---normal-distribution" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> <code>rnorm()</code> - Normal Distribution<a href="programming-practical---p2.html#rnorm---normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider a Normal Distribution with mean and standard deviation.</p>
<p>The R function <code>rnorm()</code> returns random numbers drawn from this distribution.</p>
<p>It takes the following arguments:</p>
<ul>
<li><span class="math inline">\(n\)</span>: number of random numbers to return</li>
<li>mean</li>
<li>sd: standard deviation</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="programming-practical---p2.html#cb55-1" aria-hidden="true" tabindex="-1"></a>norm.dat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb55-2"><a href="programming-practical---p2.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(norm.dat)</span></code></pre></div>
<pre><code>## [1]  0.04816033  0.37308178 -0.33625093 -1.72855767 -0.55866863</code></pre>
<p>Consider a Normal Distribution with mean 0 and variable 1. We will draw thousands of random numbers from this distribution and plot a histogram of them. This should then look like the theoretical Normal Distribution curve we produce with <code>dnorm()</code>.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="programming-practical---p2.html#cb57-1" aria-hidden="true" tabindex="-1"></a>norm.dat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50000</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb57-2"><a href="programming-practical---p2.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(norm.dat, <span class="at">prob =</span> T, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb57-3"><a href="programming-practical---p2.html#cb57-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb57-4"><a href="programming-practical---p2.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-59-1.png" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="example-one---using-probabilities-for-simulation" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Example one - using probabilities for simulation<a href="programming-practical---p2.html#example-one---using-probabilities-for-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider tossing a biased coin. There are two outcomes: Heads or Tails.</p>
<p><span class="math inline">\(P(H) = \frac{1}{3}\)</span> &amp; <span class="math inline">\(P(T) = \frac{2}{3}\)</span></p>
<p>How can we use probability distributions in R to simulate this?</p>
<div id="binomial-distribution" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Binomial Distribution<a href="programming-practical---p2.html#binomial-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using the Binomial Distribution:</p>
<ul>
<li>1 observation</li>
<li>1 trial</li>
<li>Probability of success (H) is <span class="math inline">\(\frac{1}{3}\)</span></li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="programming-practical---p2.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(</span>
<span id="cb58-2"><a href="programming-practical---p2.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,  <span class="co"># number of observation</span></span>
<span id="cb58-3"><a href="programming-practical---p2.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,  <span class="co"># number of binomial trials</span></span>
<span id="cb58-4"><a href="programming-practical---p2.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span> <span class="co"># binomial probability of success</span></span>
<span id="cb58-5"><a href="programming-practical---p2.html#cb58-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p><code>rbinom()</code> returns the number of successes from our 1 observation of tossing a biased coin once.</p>
<ul>
<li>0: <span class="math inline">\(\frac{2}{3}\)</span> of the time</li>
<li>1: <span class="math inline">\(\frac{1}{3}\)</span> of the time</li>
</ul>
<p>We can check this by getting R to do many observations at once…</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="programming-practical---p2.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">15</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  [1] 1 0 1 1 0 1 0 0 0 0 0 1 0 0 1</code></pre>
</div>
<div id="normal-distribution" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Normal Distribution<a href="programming-practical---p2.html#normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using the Normal Distribution:</p>
<p>Generate single number uniformly between 0 and 1.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="programming-practical---p2.html#cb62-1" aria-hidden="true" tabindex="-1"></a>rand <span class="ot">&lt;-</span> <span class="fu">runif</span>(</span>
<span id="cb62-2"><a href="programming-practical---p2.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,  <span class="co"># number of observation</span></span>
<span id="cb62-3"><a href="programming-practical---p2.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,  <span class="co"># minimum</span></span>
<span id="cb62-4"><a href="programming-practical---p2.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>   <span class="co"># maximum</span></span>
<span id="cb62-5"><a href="programming-practical---p2.html#cb62-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-6"><a href="programming-practical---p2.html#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) {</span>
<span id="cb62-7"><a href="programming-practical---p2.html#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Heads&quot;</span>)</span>
<span id="cb62-8"><a href="programming-practical---p2.html#cb62-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb62-9"><a href="programming-practical---p2.html#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Tails&quot;</span>)</span>
<span id="cb62-10"><a href="programming-practical---p2.html#cb62-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Heads&quot;</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="programming-practical---p2.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rand) <span class="co"># confirm by printing rand</span></span></code></pre></div>
<pre><code>## [1] 0.1177264</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-63-1.png" style="display: block; margin: auto;" /></p>
<p>The shaded area corresponds to the probability of drawing Heads.</p>
</div>
</div>
<div id="example-two---multiple-choices" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Example two - multiple choices<a href="programming-practical---p2.html#example-two---multiple-choices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider tossing a very thick biased coin. There are three outcomes: Heads, Tails, or edge.</p>
<ul>
<li><span class="math inline">\(P(H) = \frac{3}{10}\)</span></li>
<li><span class="math inline">\(P(T) = \frac{6}{10}\)</span></li>
<li><span class="math inline">\(P(E) = \frac{1}{10}\)</span></li>
</ul>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
How can we use probability distributions in R to simulate this?
</div>
</div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="programming-practical---p2.html#cb66-1" aria-hidden="true" tabindex="-1"></a>rand <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb66-2"><a href="programming-practical---p2.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">10</span>) {</span>
<span id="cb66-3"><a href="programming-practical---p2.html#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Heads&quot;</span>) </span>
<span id="cb66-4"><a href="programming-practical---p2.html#cb66-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="dv">9</span><span class="sc">/</span><span class="dv">10</span>) {</span>
<span id="cb66-5"><a href="programming-practical---p2.html#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Tails&quot;</span>)</span>
<span id="cb66-6"><a href="programming-practical---p2.html#cb66-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb66-7"><a href="programming-practical---p2.html#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;Edge&quot;</span>)</span>
<span id="cb66-8"><a href="programming-practical---p2.html#cb66-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Tails&quot;</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="programming-practical---p2.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rand) <span class="co"># confirm by printing rand</span></span></code></pre></div>
<pre><code>## [1] 0.6496403</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-66-1.png" style="display: block; margin: auto;" /></p>
<p>The blue shaded area corresponds to the probability of drawing Heads. The red shaded area corresponds to the probability of drawing Tails. The unshaded area corresponds to the probability of drawing Edge.</p>
</div>
<div id="exercise-one---using-r-to-model-a-die" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Exercise one - using R to model a die<a href="programming-practical---p2.html#exercise-one---using-r-to-model-a-die" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider a regular six-sided die.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">

<p>How could we simulate a single throw of a die?</p>
<ul>
<li>What are the possible outcomes?</li>
<li>Use <code>runif()</code></li>
<li>Use (lots of) <code>if else</code> statements
</div>
</div></li>
</ul>
<button id="displayTextunnamed-chunk-68" onclick="javascript:toggle(&#39;unnamed-chunk-68&#39;);">
Show: Solution
</button>
<div id="toggleTextunnamed-chunk-68" style="display: none">
<div class="panel panel-default">
<div class="panel-heading panel-heading1">
Solution
</div>
<div class="panel-body">
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="programming-practical---p2.html#cb70-1" aria-hidden="true" tabindex="-1"></a>rand <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb70-2"><a href="programming-practical---p2.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>) {</span>
<span id="cb70-3"><a href="programming-practical---p2.html#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="dv">1</span>)</span>
<span id="cb70-4"><a href="programming-practical---p2.html#cb70-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>) {</span>
<span id="cb70-5"><a href="programming-practical---p2.html#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="dv">2</span>)</span>
<span id="cb70-6"><a href="programming-practical---p2.html#cb70-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>) {</span>
<span id="cb70-7"><a href="programming-practical---p2.html#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="dv">3</span>)</span>
<span id="cb70-8"><a href="programming-practical---p2.html#cb70-8" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>) {</span>
<span id="cb70-9"><a href="programming-practical---p2.html#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="dv">4</span>)</span>
<span id="cb70-10"><a href="programming-practical---p2.html#cb70-10" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (rand <span class="sc">&lt;</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>) {</span>
<span id="cb70-11"><a href="programming-practical---p2.html#cb70-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="dv">5</span>)</span>
<span id="cb70-12"><a href="programming-practical---p2.html#cb70-12" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb70-13"><a href="programming-practical---p2.html#cb70-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="dv">6</span>)</span>
<span id="cb70-14"><a href="programming-practical---p2.html#cb70-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
</div>
</div>
</div>
</div>
<div id="example-three---using-r-to-model-a-death-process-stochastically" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Example three - using R to model a death process stochastically<a href="programming-practical---p2.html#example-three---using-r-to-model-a-death-process-stochastically" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider a population of animals. Every year each animal has a fixed probability of dying (depressing I know!), independently of each other and how old they are. There are no new animals born.</p>
<div class="panel panel-default">
<div class="panel-heading">
Task
</div>
<div class="panel-body">
How could we model this?
</div>
</div>
<ul>
<li>Need a program that keeps track of number of live animals</li>
<li>At each time step, we need to ‘roll a die’ to see if each live animal survives</li>
<li>We update the numbers of live animals and keep going until everything dies!</li>
</ul>
<p>This is easy to do in R.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="programming-practical---p2.html#cb72-1" aria-hidden="true" tabindex="-1"></a>nAlive <span class="ot">&lt;-</span> <span class="dv">100</span>                       <span class="co"># current number of live animals</span></span>
<span id="cb72-2"><a href="programming-practical---p2.html#cb72-2" aria-hidden="true" tabindex="-1"></a>max.time <span class="ot">&lt;-</span> <span class="dv">200</span>                     <span class="co"># keep going for up to 200 steps</span></span>
<span id="cb72-3"><a href="programming-practical---p2.html#cb72-3" aria-hidden="true" tabindex="-1"></a>nAliveStore <span class="ot">&lt;-</span> <span class="fu">numeric</span>(max.time<span class="sc">+</span><span class="dv">1</span>)  <span class="co"># vector to store how many were alive at each step</span></span>
<span id="cb72-4"><a href="programming-practical---p2.html#cb72-4" aria-hidden="true" tabindex="-1"></a>nAliveStore[<span class="dv">1</span>] <span class="ot">&lt;-</span> nAliveStore       <span class="co"># store how many were alive at the start</span></span></code></pre></div>
<pre><code>## Warning in nAliveStore[1] &lt;- nAliveStore: number of items to replace is not a
## multiple of replacement length</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="programming-practical---p2.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (iTim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max.time) {          <span class="co"># loop over all time steps</span></span>
<span id="cb74-2"><a href="programming-practical---p2.html#cb74-2" aria-hidden="true" tabindex="-1"></a>    pr <span class="ot">&lt;-</span> <span class="fu">runif</span>(nAlive, <span class="dv">0</span>, <span class="dv">1</span>)       <span class="co"># get probability of dying for all currently live animals</span></span>
<span id="cb74-3"><a href="programming-practical---p2.html#cb74-3" aria-hidden="true" tabindex="-1"></a>    died <span class="ot">&lt;-</span> <span class="fu">which</span>(pr <span class="sc">&lt;</span> <span class="fl">0.05</span>)        <span class="co"># find out which animals have died</span></span>
<span id="cb74-4"><a href="programming-practical---p2.html#cb74-4" aria-hidden="true" tabindex="-1"></a>    nDead <span class="ot">&lt;-</span> <span class="fu">length</span>(died)           <span class="co"># count up how many animals have died</span></span>
<span id="cb74-5"><a href="programming-practical---p2.html#cb74-5" aria-hidden="true" tabindex="-1"></a>    nAlive <span class="ot">&lt;-</span> nAlive <span class="sc">-</span> nDead        <span class="co"># update the number of currently living animals</span></span>
<span id="cb74-6"><a href="programming-practical---p2.html#cb74-6" aria-hidden="true" tabindex="-1"></a>    nAliveStore[iTim <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> nAlive <span class="co"># store the number of living animals</span></span>
<span id="cb74-7"><a href="programming-practical---p2.html#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (nAlive <span class="sc">&lt;=</span> <span class="dv">0</span>) {<span class="cf">break</span>}        <span class="co"># stop process when all animals are dead</span></span>
<span id="cb74-8"><a href="programming-practical---p2.html#cb74-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-9"><a href="programming-practical---p2.html#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="programming-practical---p2.html#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nAliveStore, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Number alive&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-1.png" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="programming-practical---p1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dynamic-models-practical.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
